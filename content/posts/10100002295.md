---
author: 夏昆冈
categories:
- 影像
- 技术
cover:
  alt: ''
  caption: ''
  image: https://images.soomal.cc/images/doc/20110817/00012775.webp
  relative: false
date: '2011-08-20T13:10:50+08:00'
description: 源自：www.soomal.com | 版权：原创 |  平均/总评分：09.60/48
summary: 将多张图像合成一张，这种操作非常常见，例如将某人的照片放到另一个场景当中，网络上流行的换脸等等，哪怕就是个图片加个Logo也是图像合成的一种，这些图像是如何合成的呢？我们用一个实例来说明……在合成时，有一个非常重要的元素会被忽略，它就是透明层，也叫蒙板、Mask层、Alpha层等等，它可以单独作为一个图像存在
tags:
- Alpha层
- 数字图像入门
- 蒙板
- 图像处理
- 透明层
- 科普
- Mask层
- 影像编解码
title: 数字图像入门 图像处理与透明层
---

将多张图像合成一张，这种操作非常常见，例如将某人的照片放到另一个场景当中，网络上流行的换脸等等，哪怕就是个图片加个Logo也是图像合成的一种，这些图像是如何合成的呢？我们用一个实例来说明。



![图像的合成-前景图像](https://images.soomal.cc/images/doc/20110817/00012774.webp)



我们用Soomal的标志作为前景图像。



![图像的合成-背景图像](https://images.soomal.cc/images/doc/20110817/00012775.webp)



使用一张浩瀚星系的模拟图作为背景图像。



![图像的合成-前景和背景合成后的图像](https://images.soomal.cc/images/doc/20110817/00012776.webp)



合成得到的结果就是Soomal的标志出现星系背景的图片之上。为什么会出现这样的结果呢？



在合成时，有一个非常重要的元素会被忽略，它就是透明层，也叫蒙板、Mask层、Alpha层等等，它可以单独作为一个图像存在，也可以作为一个“层”包含在图像当中，例如PNG、TGA等格式就支持存储透明层。它如何存在并不重要，重要的是它会如何影响合成的结果，有一点很重要的是，透明层一定是灰度的图像。



![图像的合成-前景背景合成时用到透明层](https://images.soomal.cc/images/doc/20110817/00012777.webp)



参与此例的合成的透明层如上图，黑底，白色的Logo，与之对应合成关系是，黑色部分为透明，白色部分为不透明。得到上面的结果就很容易理解了。如果我们把透明层的黑白关系对调一下会怎样？



![图像的合成-透明层黑白反转后，前景和背景合成的图像](https://images.soomal.cc/images/doc/20110817/00012778.webp)



得到的结果就是这样，星系背景图案只会在Logo的区域内出现，而且Logo原有的图案信息丢失。



![图像的合成-修改透明层，让白色部分产生渐变](https://images.soomal.cc/images/doc/20110817/00012779.webp)



如果把透明层的Logo部分修改成渐变会出现什么样的变化？



![图像的合成-修改透明层，让白色部分产生渐变，然后合成的结果](https://images.soomal.cc/images/doc/20110817/00012780.webp)



结果是Soomal的标志产生了透明渐变，并合成到背景当中。



实例演示到这里，透明层与合成结果的关系应该比较清晰了。前景图像的是如何合成到背景当中，其实由透明层决定。



透明层为灰度图像，深浅变化范围为0-255，当透明层的灰度值为0，透明率为100%，中度灰[灰度值127]时为50%，灰度值为255时[白色]，透明度为0%。



知道透明度后，该如何进行运算？



前景RGB（R x 透明度,G x 透明度,Bx透明度)+背景RGB（R x（100%-透明度）,G x（100%-透明度,B 
x（100%-透明度)=合成后的新像素的颜色值



这种计算可以产生上面实例中的那一组效果。当然，并不一定都是这样，修改合成时的算法，还能衍生出其他新的合成效果。



![图像的合成-其他合成效果](https://images.soomal.cc/images/doc/20110817/00012781.webp)



![图像的合成-其他合成效果](https://images.soomal.cc/images/doc/20110817/00012782.webp)



![图像的合成-其他合成效果](https://images.soomal.cc/images/doc/20110817/00012783.webp)



例如这几种效果等等，这种结果产生不一定是加法运算后的结果。其实，具体算法怎么样，对于非程序员来说，并不重要，对于普通用户，只要记住一点，在图像合成中，透明层非常重要。当理解了透明层的作用，就能够知道换脸、换背景等等常见处理的基本原理。